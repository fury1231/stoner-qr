1. 專案簡介
1.1 專案概述
本專案旨在為線下實體店面的「尋寶」活動，開發一套輕量級的網頁應用系統。顧客需親自前往指定的數個尋寶地點，掃描該地點的專屬 QR Code，透過手機網頁完成一次性的「踩點」紀錄。完成踩點後，顧客即可返回店裡，由店員核對資格後，獲得一次抽獎機會。

1.2 專案目標
提升顧客互動： 透過遊戲化的尋寶活動，增加品牌與顧客的互動性與趣味性。

驗證活動參與： 建立一套可靠的機制，確保顧客確實到達指定地點，保證活動公平性。

簡化核銷流程： 提供店員一個簡單快速的操作後台，用以核對顧客資格並完成兌換，避免人工記帳的錯誤與繁瑣。

防止作弊行為： 系統需具備基本的防弊機制，防止同一人重複領取資格或分享連結給他人。

1.3 使用者角色
顧客 (Customer)： 活動的主要參與者，使用手機掃描 QR Code 並進行操作。

店員 (Staff)： 活動的執行者，使用後台系統核對顧客資格並進行核銷。

2. 系統功能需求 (Functional Requirements)
本系統主要由三個部分構成：A. 顧客端踩點網頁、B. 店員端管理後台、C. 後端伺服器與資料庫。

2.1 A. 顧客端踩點網頁 (Frontend)
此為顧客掃描 QR Code 後會進入的手機網頁。

FR-A1: 地點參數識別

網頁必須能讀取並識別 URL 中的地點參數 (e.g., ?spot_id=location_A)。

如果 URL 中沒有有效的 spot_id 參數，應顯示錯誤或引導頁面。

FR-A2: 使用者資訊輸入

頁面需包含一個輸入欄位，讓顧客輸入其「手機號碼」作為唯一識別碼。

需有前端的基礎驗證，確保輸入的格式為台灣手機號碼 (例如：10位數字，09開頭)。

FR-A3: 提交與回饋

頁面需有一個清晰的提交按鈕 (例如：「領取我的抽獎資格」)。

按下按鈕後，網頁會將 spot_id 和 手機號碼 發送到後端伺服器。

成功狀態： 收到後端成功回應後，頁面顯示成功訊息，例如：「恭喜！您已成功在 [地點名稱] 踩點！請憑手機號碼 0912-345-678 至店裡兌換抽獎機會。」

失敗狀態： 收到後端錯誤回應後，需顯示對應的錯誤訊息，例如：「您今天已在此地領取過資格囉！」或「系統忙碌中，請稍後再試。」

2.2 B. 店員端管理後台 (Admin Panel)
此為一個具備權限控管的內部網頁，僅供店員使用。

FR-B1: 安全登入機制

後台需有帳號密碼登入頁面，防止未經授權的訪問。

FR-B2: 資格查詢功能

登入後，頁面核心功能為一個查詢框，讓店員輸入顧客的「手機號碼」進行查詢。

FR-B3: 查詢結果顯示

查詢結果需以列表形式清晰展示該手機號碼所有「未使用 (issued)」的抽獎資格。

每筆資格應至少顯示：尋寶地點名稱、領取時間。

若查無任何未使用的資格，應顯示「查無可兌換的抽獎資格」的提示。

FR-B4: 資格核銷功能

在每一筆未使用的資格旁，需有一個「核銷/兌換 (Redeem)」按鈕。

店員點擊按鈕後，系統會向後端發送請求，將該筆資格的狀態更新為「已使用 (redeemed)」。

操作前最好有一個二次確認的提示框 (例如：「確定要為此顧客兌換抽獎機會嗎？」)。

FR-B5: 核銷後狀態更新

核銷成功後，該筆紀錄應在頁面上消失或變為反灰的「已兌換」狀態，防止重複操作。

2.3 C. 後端伺服器與資料庫 (Backend & Database)
FR-C1: API - 資格領取

需提供一個 API 端點，接收來自顧客端網頁的 POST 請求 (包含 spot_id 和 手機號碼)。

核心邏輯：

驗證 spot_id 是否為活動定義的有效ID。

查詢資料庫，檢查 手機號碼 + spot_id 的組合是否已存在。若存在，則返回錯誤。

若不存在，則生成一筆新的紀錄存入資料庫，狀態設為 issued，並返回成功訊息。

FR-C2: API - 資格查詢

需提供一個 API 端點，接收來自店員後台的 GET 請求 (包含 手機號碼)。

查詢資料庫，返回該手機號碼所有 status = 'issued' 的紀錄。

FR-C3: API - 資格核銷

需提供一個 API 端點，接收來自店員後台的 POST 或 PUT 請求 (包含要核銷的紀錄 id 或 serial_number)。

將資料庫中對應紀錄的 status 從 issued 更新為 redeemed，並記錄核銷時間。

FR-C4: 資料庫結構

需建立一個名為 lottery_tickets (或類似名稱) 的資料表，至少包含以下欄位：

id (INT, Primary Key, Auto Increment)

serial_number (VARCHAR, Unique): 系統內部唯一序號

user_id (VARCHAR): 顧客的手機號碼

spot_id (VARCHAR): 尋寶地點ID

status (ENUM('issued', 'redeemed')): 狀態

created_at (TIMESTAMP): 領取時間

redeemed_at (TIMESTAMP, Nullable): 核銷時間

3. 非功能性需求 (Non-Functional Requirements)
NF-1: 使用者介面 (UI/UX)

所有頁面需採響應式網頁設計 (RWD)，優先考慮在手機上的瀏覽體驗。

介面設計應簡潔、直觀，易於操作。

NF-2: 效能 (Performance)

所有頁面載入和 API 回應時間應在 3 秒內完成。

NF-3: 安全性 (Security)

店員後台需有基本的安全防護，防止未授權存取。

所有使用者輸入的資料在存入資料庫前，需進行清理與驗證，防止 SQL Injection 等攻擊。

NF-4: 可擴充性 (Scalability)

尋寶地點 (spot_id 與其對應的名稱) 應設計為可配置的，方便未來新增或修改活動地點，而無需修改程式碼。

4. 交付項目 (Deliverables)
系統原始碼： 包含前端、後端所有程式碼，並附有清晰的註解。

部署說明文件： 詳細說明如何在伺服器上安裝、配置及啟動此系統。

QR Code 網址列表： 提供所有尋寶地點應生成的 QR Code 對應網址列表。

後台管理帳號： 提供一組預設的店員後台管理員帳號密碼。

5. 附註與假設
本專案不包含實體的抽獎機制（如抽獎箱、線上抽獎輪盤等），僅處理到「賦予抽獎資格」並核銷的環節。

專案所需的伺服器、網域等基礎設施由我方提供/指定。

活動地點的具體名稱、spot_id 的命名規則將由我方提供。
